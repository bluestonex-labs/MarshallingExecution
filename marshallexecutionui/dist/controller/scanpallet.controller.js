sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox"],(e,t)=>{"use strict";return e.extend("com.sysco.wm.marshallexecutionui.marshallexecutionui.controller.scanpallet",{onInit(){this.getOwnerComponent().getRouter().getRoute("scanpallet").attachPatternMatched(this._onRouteMatched,this);this.oBundle=this.getOwnerComponent().getModel("i18n").getResourceBundle()},_onRouteMatched:function(e){var t=this.getOwnerComponent().getModel("SuggestedMoveData").getData();this.oData=t.data.value;var a=this.getOwnerComponent().getManifestEntry("/sap.app/id");var s=a.replaceAll(".","/");this.appModulePath=jQuery.sap.getModulePath(s);var o=this.getOwnerComponent().getRouter();this.oBundle=this.getOwnerComponent().getModel("i18n").getResourceBundle();this.getView().byId("scanPalMovePalID1").setEnabled(true);this.getView().byId("scanPalMoveID1").setEnabled(true);this.getView().byId("scanPalMoveID1").setValue();this.getView().byId("scanPalMoveID1").setValueState("None");this.getView().byId("scanPalMovePalID1").setValue();this.getView().byId("scanPalMovePalID1").setValueState("None");this.getView().byId("scanPalMoveRoute1").setValue();this.getView().byId("scanPalMoveConsoRoute1").setValue();this.getView().byId("scanPalMoveSrc1").setValue();this.getView().byId("scanPalMoveDest1").setValue()},onConfirmMove:function(e){var t=this.getView();if(!this._oWrapDialogs){this._oWrapDialogs=sap.ui.xmlfragment(t.getId(),"com.sysco.wm.marshallexecutionui.marshallexecutionui.fragment.wrapDialog",this);t.addDependent(this._oWrapDialogs)}this._oWrapDialogs.open()},_closeWrapDialogAccept:function(e){var t=this;if(this._oWrapDialogs){this._oWrapDialogs.close();var a=t.callConfirmMoves();sap.m.MessageBox.information(t.oBundle.getText("lbl"),{actions:[sap.m.MessageBox.Action.OK],onClose:function(e){if(e===sap.m.MessageBox.Action.OK){sap.ui.core.UIComponent.getRouterFor(this).navTo("Routescanlabel")}}.bind(t)})}},callConfirmMoves:function(){return new Promise((e,t)=>{var a=this;var s=sap.ui.getCore().getConfiguration().getLocale();var o=s.language;var i=this.appModulePath+"/marshallingservices/Marshalling/confirmMove";var n={IDs:[a.val]};$.ajax({url:i,beforeSend:function(e){e.setRequestHeader("Accept-Language",o)},method:"POST",contentType:"application/json",data:JSON.stringify(n),headers:{Accept:"application/json"},success:function(t){e(t.value)},error:function(e){t(e)}})})},_closeWrapDialogDecline:function(e){if(this._oWrapDialogs){this._oWrapDialogs.close()}},onCageIDInput:function(e){var t=this;var a=e.getParameter("value").trim();this.getView().byId("scanPalMovePalID1").setValue();var s=this.oData.filter(function(e){if(e.To_Marshalling.CageID==a){return e}});this.getView().byId("scanPalMoveID1").setValueState("None");if(s.length==0&&a!=""){sap.m.MessageBox.error(t.oBundle.getText("enter_correct_cage"));this.getView().byId("scanPalMoveID1").setValueState("Error");this.getView().byId("scanPalMoveRoute1").setValue();this.getView().byId("scanPalMoveConsoRoute1").setValue();this.getView().byId("scanPalMoveSrc1").setValue();this.getView().byId("scanPalMoveDest1").setValue();return}this.val=s[0]?.To_Marshalling?.ID||"";var o=new sap.ui.model.json.JSONModel(s);this.getView().setModel(o,"scanPalMove1");this.getView().byId("scanPalMoveRoute1").setValue(s[0]?.Route||"");this.getView().byId("scanPalMoveConsoRoute1").setValue(s[0]?.To_Marshalling?.Route||"");this.getView().byId("scanPalMoveSrc1").setValue(s[0]?.To_Marshalling?.MarshallingBinID?.Description||"");this.getView().byId("scanPalMoveDest1").setValue(s[0]?.To_Marshalling?.SuggestedBinID?.Description||"")},onPalletIDInput:function(e){var t=this;var a=e.getParameter("value").trim();this.getView().byId("scanPalMoveID1").setValue();var s=this.oData.filter(function(e){if(e.To_Marshalling.PalletID==a){return e}});this.getView().byId("scanPalMovePalID1").setValueState("None");if(s.length==0&&a!=""){sap.m.MessageBox.error(t.oBundle.getText("enter_correct_cage"));this.getView().byId("scanPalMovePalID1").setValueState("Error");this.getView().byId("scanPalMoveRoute1").setValue();this.getView().byId("scanPalMoveConsoRoute1").setValue();this.getView().byId("scanPalMoveSrc1").setValue();this.getView().byId("scanPalMoveDest1").setValue();return}this.val=s[0]?.To_Marshalling?.ID||"";var o=new sap.ui.model.json.JSONModel(s);this.getView().setModel(o,"scanPalMove1");this.getView().byId("scanPalMoveRoute1").setValue(s[0]?.Route||"");this.getView().byId("scanPalMoveConsoRoute1").setValue(s[0]?.To_Marshalling?.Route||"");this.getView().byId("scanPalMoveSrc1").setValue(s[0]?.To_Marshalling?.MarshallingBinID?.Description||"");this.getView().byId("scanPalMoveDest1").setValue(s[0]?.To_Marshalling?.SuggestedBinID?.Description||"")}})});
//# sourceMappingURL=scanpallet.controller.js.map